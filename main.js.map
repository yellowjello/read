{"version":3,"sources":["./src/app/auto-scroller.service.ts","./src/app/ebook-display-manager.service.ts","./src/environments/environment.ts","./src/app/utils/html-fixer.ts","./src/app/reader/reader.component.ts","./src/app/reader/reader.component.html","./src/app/settings-dialog/settings-dialog.component.ts","./src/app/settings-dialog/settings-dialog.component.html","./src/app/utils/extractor.ts","./src/app/utils/css-parser.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/database.service.ts","./src/app/utils/smooth-scroll.ts","./src/app/utils/css-stringify.ts","./src/app/theme-manager.service.ts","./src/app/bookmark-manager.service.ts","./src/app/app-routing.module.ts","./src/app/scroll-information.service.ts","./src/main.ts","./$_lazy_route_resource lazy namespace object"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Injectable } from '@angular/core';\n\nconst autoScrollMultiplierKey = 'autoScrollMultiplier';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AutoScrollerService {\n\n  activated = false;\n  multiplier: number;\n\n  constructor() {\n    const storedMultiplier = localStorage.getItem(autoScrollMultiplierKey);\n    if (storedMultiplier) {\n      this.multiplier = +storedMultiplier;\n    } else {\n      this.multiplier = 20;\n    }\n  }\n\n  increaseSpeed() {\n    this.multiplier += 1;\n    localStorage.setItem(autoScrollMultiplierKey, `${this.multiplier}`);\n  }\n\n  decreaseSpeed() {\n    this.multiplier = Math.max(1, this.multiplier - 1);\n    localStorage.setItem(autoScrollMultiplierKey, `${this.multiplier}`);\n  }\n\n  stop() {\n    this.activated = false;\n  }\n\n  toggle() {\n    this.activated = !this.activated;\n\n    if (this.activated) {\n      this.autoScrollTick(Date.now(), document.documentElement.scrollLeft);\n    }\n  }\n\n  private autoScrollTick(previousTick: number, expectedPos: number) {\n    const currentTick = Date.now();\n    const pixelsPerMs = -0.00091489 * this.multiplier;\n\n    let calculatedCurrentPos: number;\n    if (Math.abs(expectedPos - document.documentElement.scrollLeft) < 1) {\n      calculatedCurrentPos = expectedPos;\n    } else {\n      // scrollLeft interrupted by something else\n      calculatedCurrentPos = document.documentElement.scrollLeft;\n    }\n    const newExpectedPos = calculatedCurrentPos + (pixelsPerMs * (currentTick - previousTick));\n\n    document.documentElement.scrollBy(newExpectedPos - document.documentElement.scrollLeft, 0);\n\n    if (this.activated) {\n      window.requestAnimationFrame(() => {\n        this.autoScrollTick(currentTick, newExpectedPos);\n      });\n    }\n  }\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { skip } from 'rxjs/operators';\n\n// https://www.unicode.org/Public/UCD/latest/ucd/PropList.txt\nconst isNotJapaneseRegex = /[^0-9A-Z-------\\p{Ideographic}\\p{Radical}\\p{Unified_Ideograph}]+/gmiu;\n\ntype loadingProgress = {\n  title: string;\n  progress: string;\n};\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EbookDisplayManagerService {\n\n  loadingFile$ = new BehaviorSubject<boolean>(false);\n  loadingFiles$ = new BehaviorSubject<loadingProgress | undefined>(undefined);\n  contentEl = document.createElement('div');\n  contentChanged = new Subject<void>();\n  revalidateFile = new Subject<void>();\n\n  fontSize$: BehaviorSubject<number>;\n  hideSpoilerImage$: BehaviorSubject<boolean>;\n  hideFurigana$: BehaviorSubject<boolean>;\n  allowScroll = true;\n  totalCharCount = 0;\n\n  private bookStyle = document.createElement('style');\n\n  constructor() {\n    document.head.insertBefore(this.bookStyle, document.head.firstChild);\n\n    const storedFontSize = localStorage.getItem('fontSize');\n    let defaultFontSize: number;\n    if (storedFontSize) {\n      defaultFontSize = +storedFontSize;\n    } else {\n      defaultFontSize = 20;\n    }\n    this.fontSize$ = new BehaviorSubject(defaultFontSize);\n\n    this.fontSize$.pipe(\n      skip(1),\n    ).subscribe((fontSize) => {\n      localStorage.setItem('fontSize', `${fontSize}`);\n    });\n\n    const storedHideSpoilerImage = localStorage.getItem('hideSpoilerImage');\n    let defaultHideSpoilerImage: boolean;\n    if (storedHideSpoilerImage) {\n      defaultHideSpoilerImage = !!(+storedHideSpoilerImage);\n    } else {\n      defaultHideSpoilerImage = true;\n    }\n    this.hideSpoilerImage$ = new BehaviorSubject(defaultHideSpoilerImage);\n\n    this.hideSpoilerImage$.pipe(\n      skip(1),\n    ).subscribe((hideSpoilerImage) => {\n      localStorage.setItem('hideSpoilerImage', hideSpoilerImage ? '1' : '0');\n    });\n\n    const storedHideFurigana = localStorage.getItem('hideFurigana');\n    let defaultHideFurigana: boolean;\n    if (storedHideFurigana) {\n      defaultHideFurigana = !!(+storedHideFurigana);\n    } else {\n      defaultHideFurigana = false;\n    }\n    this.hideFurigana$ = new BehaviorSubject(defaultHideFurigana);\n\n    this.hideFurigana$.pipe(\n      skip(1),\n    ).subscribe((hideFurigana) => {\n      localStorage.setItem('hideFurigana', hideFurigana ? '1' : '0');\n    });\n  }\n\n  updateContent(el: HTMLElement, styleString: string) {\n    if (this.contentEl.firstChild) {\n      this.contentEl.replaceChild(el, this.contentEl.firstChild);\n    } else {\n      this.contentEl.appendChild(el);\n    }\n\n    const styleNode = document.createTextNode(styleString);\n    if (this.bookStyle.firstChild) {\n      this.bookStyle.replaceChild(styleNode, this.bookStyle.firstChild);\n    } else {\n      this.bookStyle.appendChild(styleNode);\n    }\n    this.contentChanged.next();\n  }\n\n  getCharCount(el: HTMLElement) {\n    const totalLength = countUnicodeCharacters(el.innerText.replace(isNotJapaneseRegex, ''));\n    let totalRtLength = 0;\n    for (const rtTag of el.getElementsByTagName('rt')) {\n      totalRtLength += countUnicodeCharacters(rtTag.innerText.replace(isNotJapaneseRegex, ''));\n    }\n    let totalCustomCharLength = 0;\n    for (const spoilerEl of el.getElementsByClassName('spoiler-label')) {\n      totalCustomCharLength += countUnicodeCharacters((spoilerEl as HTMLElement).innerText.replace(isNotJapaneseRegex, ''));\n    }\n    for (const placeholderEl of el.getElementsByClassName('placeholder-br')) {\n      totalCustomCharLength += countUnicodeCharacters((placeholderEl as HTMLElement).innerText.replace(isNotJapaneseRegex, ''));\n    }\n    let imageTextCount = 0;\n    for (const imgTag of el.getElementsByTagName('img')) {\n      if ([...imgTag.classList.values()].some((className) => className.includes('gaiji'))) {\n        imageTextCount += 1;\n      }\n    }\n    return totalLength - totalRtLength - totalCustomCharLength + imageTextCount;\n  }\n}\n\n/**\n * Because ''.length = 3\n * Reference: https://dmitripavlutin.com/what-every-javascript-developer-should-know-about-unicode/#length-and-surrogate-pairs\n */\nfunction countUnicodeCharacters(s: string) {\n  return [...s].length;\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport path from 'path-browserify';\nimport { EpubContents } from './epub-types';\n\nfunction childNodesAfterContents(el: HTMLElement) {\n  let childNodes = [...el.children];\n  const afterContentsDivIndex = childNodes.findIndex((childNode) => childNode.getElementsByTagName('a').length > 1) + 1;\n  if (afterContentsDivIndex > 0 && afterContentsDivIndex < childNodes.length) {\n    childNodes = childNodes.slice(afterContentsDivIndex);\n  }\n  return childNodes;\n}\n\n/**\n * Clear all references that aren't packed, which could be caused by:\n * - Bad input file (doesn't include the required image)\n * - Bad image file extension\n */\nfunction clearBadImageRef(el: HTMLElement) {\n  for (const tag of el.getElementsByTagName('image')) {\n    const hrefAttr = tag.getAttribute('href');\n    if (hrefAttr && !(hrefAttr.startsWith('ttu:') || hrefAttr.startsWith('data:image/gif;ttu:'))) {\n      tag.setAttribute('data-ttu-href', hrefAttr);\n      tag.removeAttribute('href');\n    }\n  }\n  for (const tag of el.getElementsByTagName('img')) {\n    const srcAttr = tag.getAttribute('src');\n    if (srcAttr && !(srcAttr.startsWith('ttu:') || srcAttr.startsWith('data:image/gif;ttu:'))) {\n      tag.setAttribute('data-ttu-src', srcAttr);\n      tag.removeAttribute('src');\n    }\n  }\n}\n\nexport function getFormattedElementHtmlz(data: Record<string, string | Blob>) {\n  // tslint:disable-next-line:no-non-null-assertion\n  const regexResult = /.*<body[^>]*>((.|\\s)+)<\\/body>.*/.exec(data['index.html'] as string)!;\n  let html = regexResult[1];\n  for (const [key, value] of Object.entries(data)) {\n    if (value instanceof Blob) {\n      html = html.replaceAll(key, buildDummyBookImage(key));\n    }\n  }\n  const result = document.createElement('div');\n  result.innerHTML = html;\n\n  for (const tag of result.getElementsByTagName('image')) {\n    if (!tag.getAttributeNames().some((x) => x === 'href')) {\n      for (const attrName of tag.getAttributeNames()) {\n        if (attrName.endsWith('href')) {\n          // tslint:disable-next-line:no-non-null-assertion\n          tag.setAttribute('href', tag.getAttribute(attrName)!);\n        }\n      }\n    }\n  }\n  for (const tag of result.getElementsByTagName('svg')) {\n    tag.removeAttribute('width');\n    tag.removeAttribute('height');\n  }\n  clearBadImageRef(result);\n\n  for (const childNode of childNodesAfterContents(result)) {\n    const createWrapper = (tag: Element) => {\n      const imgWrapper = document.createElement('span');\n      imgWrapper.toggleAttribute('data-ttu-spoiler-img');\n      const parentElement = tag.parentElement || childNode;\n      parentElement.insertBefore(imgWrapper, tag);\n      imgWrapper.appendChild(tag);\n    };\n\n    for (const tag of childNode.getElementsByTagName('img')) {\n      if (![...tag.classList.values()].some((className) => className.includes('gaiji'))) {\n        createWrapper(tag);\n      }\n    }\n\n    for (const tag of childNode.getElementsByTagName('svg')) {\n      if (tag.getElementsByTagName('image').length) {\n        createWrapper(tag);\n      }\n    }\n  }\n\n  for (const tag of result.getElementsByTagName('br')) {\n    const placeholderEl = document.createElement('span'); // for Firefox\n    placeholderEl.classList.add('placeholder-br');\n    placeholderEl.setAttribute('aria-hidden', 'true');\n    placeholderEl.innerText = '';\n    const parentElement = tag.parentElement || result;\n    parentElement.insertBefore(placeholderEl, tag);\n  }\n\n  return result;\n}\n\nconst prependValue = 'ttu-';\n\nexport function getFormattedElementEpub(data: Record<string, string | Blob>, contents: EpubContents) {\n\n  const htmlMap = contents.package.manifest.item.reduce<Record<string, string>>((acc, item) => {\n    if (item['@_media-type'] === 'application/xhtml+xml') {\n      acc[item['@_id']] = item['@_href'];\n    }\n    return acc;\n  }, {});\n\n  const blobsAvailable = Object.entries(data).reduce<string[]>((acc, [key, value]) => {\n    if (value instanceof Blob) {\n      acc.push(key);\n    }\n    return acc;\n  }, []);\n\n  const result = document.createElement('div');\n  for (const item of contents.package.spine.itemref) {\n    const idRef = item['@_idref'];\n    const htmlHref = htmlMap[idRef] || '';\n    // tslint:disable-next-line:no-non-null-assertion\n    const regexResult = /.*<body[^>]*>((.|\\s)+)<\\/body>.*/.exec(data[htmlHref] as string)!;\n    let innerHtml: string = regexResult[1];\n    for (const blobKey of blobsAvailable) {\n      innerHtml = innerHtml.replaceAll(relative(htmlHref, blobKey), buildDummyBookImage(blobKey));\n    }\n    const childDiv = document.createElement('div');\n    childDiv.innerHTML = innerHtml;\n    childDiv.id = `${prependValue}${idRef}`;\n    result.appendChild(childDiv);\n  }\n\n  for (const tag of result.getElementsByTagName('a')) {\n    const oldHref = tag.getAttribute('href');\n    if (oldHref) {\n      tag.setAttribute('href', '#' + oldHref.replace(/.+#/, ''));\n    }\n  }\n\n  for (const tag of result.getElementsByTagName('image')) {\n    if (!tag.getAttributeNames().some((x) => x === 'href')) {\n      for (const attrName of tag.getAttributeNames()) {\n        if (attrName.endsWith('href')) {\n          // tslint:disable-next-line:no-non-null-assertion\n          tag.setAttribute('href', tag.getAttribute(attrName)!);\n        }\n      }\n    }\n  }\n  for (const tag of result.getElementsByTagName('svg')) {\n    tag.removeAttribute('width');\n    tag.removeAttribute('height');\n  }\n  clearBadImageRef(result);\n\n  for (const childNode of childNodesAfterContents(result)) {\n    const createWrapper = (tag: Element) => {\n      const imgWrapper = document.createElement('span');\n      imgWrapper.toggleAttribute('data-ttu-spoiler-img');\n      const parentElement = tag.parentElement || childNode;\n      parentElement.insertBefore(imgWrapper, tag);\n      imgWrapper.appendChild(tag);\n    };\n\n    for (const tag of childNode.getElementsByTagName('img')) {\n      if (![...tag.classList.values()].some((className) => className.includes('gaiji'))) {\n        createWrapper(tag);\n      }\n    }\n\n    for (const tag of childNode.getElementsByTagName('svg')) {\n      if (tag.getElementsByTagName('image').length) {\n        createWrapper(tag);\n      }\n    }\n  }\n\n  for (const tag of result.getElementsByTagName('br')) {\n    const placeholderEl = document.createElement('span'); // for Firefox\n    placeholderEl.classList.add('placeholder-br');\n    placeholderEl.setAttribute('aria-hidden', 'true');\n    placeholderEl.innerText = '';\n    const parentElement = tag.parentElement || result;\n    parentElement.insertBefore(placeholderEl, tag);\n  }\n\n  return result;\n}\n\nfunction relative(fromPath: string, toPath: string): string {\n  const fromDirName = path.dirname(fromPath);\n  const toDirName = path.dirname(toPath);\n  const toFilename = path.basename(toPath);\n\n  if (fromDirName === toDirName) {\n    return toFilename;\n  }\n\n  const fromParts = fromDirName === '.' ? [] : fromDirName.split('/');\n  const toParts = toDirName === '.' ? [] : toDirName.split('/');\n\n  if (fromParts.length >= toParts.length) {\n    for (let i = 0; i < fromParts.length; i += 1) {\n      if (fromParts[i] !== toParts[i]) {\n        return path.join('../'.repeat(fromParts.length - i) + toParts.slice(i).join('/'), toFilename);\n      }\n    }\n  }\n  for (let i = 0; i < fromParts.length; i += 1) {\n    if (fromParts[i] !== toParts[i]) {\n      return path.join('../'.repeat(fromParts.length - i) + toParts.slice(i).join('/'), toFilename);\n    }\n  }\n\n  return path.join(toParts.slice(fromParts.length - toParts.length).join('/'), toFilename);\n}\n\nexport function buildDummyBookImage(key: string) {\n  return `data:image/gif;ttu:${key};base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==`;\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Component, ElementRef, NgZone, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { Title } from '@angular/platform-browser';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport { combineLatest, fromEvent, merge, ReplaySubject, Subject } from 'rxjs';\nimport { debounceTime, filter, map, startWith, switchMap, take, takeUntil, withLatestFrom } from 'rxjs/operators';\nimport { BookmarkManagerService } from '../bookmark-manager.service';\nimport { DatabaseService } from '../database.service';\nimport { EbookDisplayManagerService } from '../ebook-display-manager.service';\nimport { ScrollInformationService } from '../scroll-information.service';\nimport { buildDummyBookImage } from '../utils/html-fixer';\nimport { SmoothScroll } from '../utils/smooth-scroll';\n\nconst enum DeltaMode {\n  DeltaPixel = 0,\n  DeltaLine = 1,\n  DeltaPage = 2,\n}\n\nconst added = false;\n\n@Component({\n  selector: 'app-reader',\n  templateUrl: './reader.component.html',\n  styleUrls: ['./reader.component.scss']\n})\nexport class ReaderComponent implements OnInit, OnDestroy {\n\n  @ViewChild('contentRef', { static: true }) contentElRef!: ElementRef<HTMLElement>;\n  private latestScrollStats?: {\n    containerWidth: number;\n    exploredCharCount: number;\n  };\n  private updatingFontSize = false;\n  private observer!: ResizeObserver;\n  private destroy$ = new Subject<void>();\n\n  constructor(\n    private title: Title,\n    public ebookDisplayManagerService: EbookDisplayManagerService,\n    private scrollInformationService: ScrollInformationService,\n    private bookmarManagerService: BookmarkManagerService,\n    private databaseService: DatabaseService,\n    private route: ActivatedRoute,\n    private router: Router,\n    private zone: NgZone,\n  ) {\n  }\n\n  ngOnInit(): void {\n    if (!added) {\n      document.body.appendChild(this.bookmarManagerService.el);\n      document.body.appendChild(this.scrollInformationService.el);\n    }\n\n    this.contentElRef.nativeElement.appendChild(this.ebookDisplayManagerService.contentEl);\n    this.zone.runOutsideAngular(() => {\n      this.ebookDisplayManagerService.fontSize$.pipe(\n        takeUntil(this.destroy$),\n      ).subscribe((fontSize) => {\n        requestAnimationFrame(() => {\n          this.updatingFontSize = true;\n          this.contentElRef.nativeElement.style.fontSize = `${fontSize}px`;\n          requestAnimationFrame(() => {\n            this.updatingFontSize = false;\n          });\n        });\n      });\n\n      const wheelEventFn = SmoothScroll(document.documentElement, 4);\n      fromEvent<WheelEvent>(document, 'wheel', { passive: false })\n        .pipe(\n          filter(() => this.ebookDisplayManagerService.allowScroll),\n          takeUntil(this.destroy$),\n        )\n        .subscribe((ev) => {\n          if (!ev.deltaY || ev.deltaX || ev.altKey || ev.shiftKey || ev.ctrlKey || ev.metaKey) {\n            return;\n          }\n\n          // https://developer.mozilla.org/en-US/docs/Web/API/WheelEvent/deltaMode\n          let scrollDistance: number;\n          switch (ev.deltaMode) {\n            case DeltaMode.DeltaPixel:\n              scrollDistance = ev.deltaY;\n              break;\n            case DeltaMode.DeltaLine:\n              scrollDistance = ev.deltaY * this.ebookDisplayManagerService.fontSize$.value * 1.75;\n              break;\n            default:\n              scrollDistance = ev.deltaY * window.innerWidth;\n          }\n\n          wheelEventFn(-scrollDistance);\n          ev.preventDefault();\n        });\n      fromEvent(window, 'scroll').pipe(\n        takeUntil(this.destroy$),\n      ).subscribe(() => {\n        const charCount = this.scrollInformationService.calcExploredCharCount();\n        this.scrollInformationService.updateScrollPercentByCharCount(\n          this.ebookDisplayManagerService.totalCharCount,\n          charCount,\n        );\n        if (!this.updatingFontSize) {\n          this.latestScrollStats = {\n            containerWidth: this.contentElRef.nativeElement.offsetWidth,\n            exploredCharCount: charCount,\n          };\n        }\n      });\n      const resizeObs$ = new ReplaySubject<void>(1);\n      window.addEventListener('resize', () => {\n        resizeObs$.next();\n      });\n      this.observer = new ResizeObserver(() => {\n        resizeObs$.next();\n      });\n      this.observer.observe(this.contentElRef.nativeElement);\n      resizeObs$.pipe(\n        withLatestFrom(this.ebookDisplayManagerService.loadingFile$),\n        filter(([, loadingFile]) => !loadingFile),\n        switchMap(() => new Promise(requestAnimationFrame)),\n        takeUntil(this.destroy$),\n      ).subscribe(() => {\n        this.scrollInformationService.updateParagraphPos();\n        if (this.latestScrollStats && Math.abs(this.latestScrollStats.containerWidth - this.contentElRef.nativeElement.offsetWidth) > 100) {\n          const scrollPos = this.scrollInformationService.getScrollPos(this.latestScrollStats.exploredCharCount);\n          window.scrollTo(scrollPos, 0);\n        }\n        this.scrollInformationService.updateScrollPercent(\n          this.ebookDisplayManagerService.totalCharCount,\n        );\n        void this.bookmarManagerService.refreshBookmarkBarPosition();\n      });\n    });\n\n    this.ebookDisplayManagerService.contentChanged.pipe(\n      takeUntil(this.destroy$),\n    ).subscribe(() => {\n      for (const el of this.ebookDisplayManagerService.contentEl.getElementsByTagName('a')) {\n        el.href = document.location.pathname + el.hash;\n      }\n    });\n\n    this.ebookDisplayManagerService.contentChanged.pipe(\n      switchMap(() => {\n        const elements = this.ebookDisplayManagerService.contentEl.getElementsByTagName('a');\n        const elementsArray = [...elements];\n        const obs$ = elementsArray.map((el) => fromEvent(el, 'click').pipe(\n          map((ev) => {\n            ev.preventDefault();\n            ev.stopImmediatePropagation();\n            return el;\n          }),\n        ));\n        return merge(...obs$);\n      }),\n      takeUntil(this.destroy$),\n    ).subscribe((el) => {\n      const targetEl = document.getElementById(el.hash.substring(1));\n      if (targetEl) {\n        targetEl.scrollIntoView();\n      }\n    });\n\n    this.ebookDisplayManagerService.contentChanged.pipe(\n      switchMap(() => {\n        const elements = this.ebookDisplayManagerService.contentEl.getElementsByTagName('ruby');\n        const elementsArray = [...elements];\n        const obs$ = elementsArray.map((el) => fromEvent(el, 'click').pipe(\n          take(1),\n          map((ev) => {\n            ev.preventDefault();\n            ev.stopImmediatePropagation();\n            return el;\n          }),\n        ));\n        return merge(...obs$);\n      }),\n      takeUntil(this.destroy$),\n    ).subscribe((el) => {\n      el.classList.add('reveal-rt');\n    });\n\n    this.ebookDisplayManagerService.contentChanged.pipe(\n      switchMap(() => {\n        const elements = this.ebookDisplayManagerService.contentEl.querySelectorAll('[data-ttu-spoiler-img]');\n        const elementsArray = [...elements];\n        const obs$ = elementsArray.map((el) => {\n          const spoilerLabelEl = document.createElement('span');\n          spoilerLabelEl.classList.add('spoiler-label');\n          spoilerLabelEl.setAttribute('aria-hidden', 'true');\n          spoilerLabelEl.innerText = '';\n          el.appendChild(spoilerLabelEl);\n          return fromEvent(el, 'click').pipe(\n            take(1),\n            map((ev) => {\n              ev.preventDefault();\n              ev.stopImmediatePropagation();\n              return [el, spoilerLabelEl];\n            }),\n          );\n        });\n        return merge(...obs$);\n      }),\n      takeUntil(this.destroy$),\n    ).subscribe(([el, spoilerLabelEl]) => {\n      el.removeChild(spoilerLabelEl);\n      el.removeAttribute('data-ttu-spoiler-img');\n    });\n\n    this.ebookDisplayManagerService.contentChanged.pipe(\n      switchMap(() => {\n        const elements = this.ebookDisplayManagerService.contentEl.getElementsByTagName('img');\n        const elementsArray = [...elements];\n        const obs$ = elementsArray.flatMap((imgEl) => [\n          fromEvent(imgEl, 'load'),\n          fromEvent(imgEl, 'error'),\n        ]);\n        return merge(...obs$).pipe(\n          startWith(0),\n          map(() => elementsArray),\n          debounceTime(1),\n        );\n      }),\n      takeUntil(this.destroy$),\n    ).subscribe(async (elementsArray) => {\n      if (elementsArray.every((imgEl) => imgEl.complete)) {\n        this.scrollInformationService.updateParagraphPos();\n        await this.bookmarManagerService.scrollToSavedPosition();\n        this.scrollInformationService.updateScrollPercent(\n          this.ebookDisplayManagerService.totalCharCount,\n        );\n        this.ebookDisplayManagerService.loadingFile$.next(false);\n      }\n    });\n\n    combineLatest([\n      this.route.paramMap,\n      this.ebookDisplayManagerService.revalidateFile.pipe(startWith(0)),\n    ]).pipe(\n      takeUntil(this.destroy$),\n    ).subscribe(async ([paramMap]) => {\n      this.ebookDisplayManagerService.loadingFile$.next(true);\n      let canLoad = false;\n      const identifier = paramMap.get('identifier');\n      if (identifier) {\n        const db = await this.databaseService.db;\n        const displayData = await db.get('data', +identifier || 0);\n        if (displayData) {\n          canLoad = true;\n          this.loadData(displayData);\n        }\n      }\n\n      if (!canLoad) {\n        this.ebookDisplayManagerService.loadingFile$.next(false);\n        await this.router.navigate(['']);\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    this.observer.disconnect();\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n\n  private loadData(data: {\n    id?: number;\n    title: string;\n    elementHtml: string;\n    styleSheet: string;\n    blobs: Record<string, Blob>,\n  }) {\n    let { elementHtml } = data;\n    const {\n      title,\n      styleSheet,\n      blobs,\n    } = data;\n    this.title.setTitle(title.trimEnd() + ' |  Ebook Reader');\n    // tslint:disable-next-line:no-non-null-assertion\n    this.bookmarManagerService.identifier = data.id!;\n    this.bookmarManagerService.el.hidden = true;\n\n    const urls: Array<string> = [];\n\n    for (const [key, value] of Object.entries(blobs)) {\n      const url = URL.createObjectURL(value);\n      urls.push(url);\n      elementHtml = elementHtml.\n        replaceAll(buildDummyBookImage(key), url).\n        replaceAll(`ttu:${key}`, url);\n    }\n\n    const element = document.createElement('div');\n    element.innerHTML = elementHtml;\n    this.ebookDisplayManagerService.totalCharCount = this.ebookDisplayManagerService.getCharCount(element);\n    this.scrollInformationService.initWatchParagraphs(element);\n    this.ebookDisplayManagerService.updateContent(element, styleSheet);\n    window.scrollTo(0, 0);\n    setTimeout(() => {\n      for (let index = 0, length = urls.length; index < length; index++) {\n        URL.revokeObjectURL(urls[index]);\n      }\n    });\n  }\n}\n","<div class=\"book-content\" #contentRef\n     [class.hide-spoiler-image]=\"ebookDisplayManagerService.hideSpoilerImage$ | async\"\n     [class.show-spoiler-image]=\"!(ebookDisplayManagerService.hideSpoilerImage$ | async)\"\n     [class.hide-furigana]=\"ebookDisplayManagerService.hideFurigana$ | async\"></div>\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { ChangeDetectorRef, Component, EventEmitter, OnInit, Output } from '@angular/core';\nimport { faMinus } from '@fortawesome/free-solid-svg-icons/faMinus';\nimport { faPlus } from '@fortawesome/free-solid-svg-icons/faPlus';\nimport { EbookDisplayManagerService } from '../ebook-display-manager.service';\nimport { ThemeManagerService } from '../theme-manager.service';\n\n\n@Component({\n  selector: 'app-settings-dialog',\n  templateUrl: './settings-dialog.component.html',\n  styleUrls: ['./settings-dialog.component.scss']\n})\nexport class SettingsDialogComponent implements OnInit {\n\n  @Output() closeClick = new EventEmitter<void>();\n\n  faMinus = faMinus;\n  faPlus = faPlus;\n\n  constructor(\n    public themeManagerService: ThemeManagerService,\n    public ebookDisplayManagerService: EbookDisplayManagerService,\n    public cdr: ChangeDetectorRef,\n  ) { }\n\n  ngOnInit(): void {\n  }\n\n  onFontSizeUpdateClick(offset: number) {\n    this.ebookDisplayManagerService.fontSize$.next(this.ebookDisplayManagerService.fontSize$.value + offset);\n    this.cdr.markForCheck();\n  }\n\n  onThemeUpdateClick(i: number) {\n    this.themeManagerService.setTheme(i);\n    this.cdr.markForCheck();\n  }\n\n  onHideSpoilerImageClick() {\n    this.ebookDisplayManagerService.hideSpoilerImage$.next(!this.ebookDisplayManagerService.hideSpoilerImage$.value);\n    this.cdr.markForCheck();\n  }\n\n  onHideFuriganaClick() {\n    this.ebookDisplayManagerService.hideFurigana$.next(!this.ebookDisplayManagerService.hideFurigana$.value);\n    this.cdr.markForCheck();\n  }\n}\n","<div class=\"dialog-padding\">\n  <header class=\"dialog-header\">Settings</header>\n  <div>\n    <div class=\"item-header\">Theme</div>\n    <div class=\"button-row\">\n      <button (click)=\"onThemeUpdateClick(i)\"\n              *ngFor=\"let theme of themeManagerService.availableThemes; index as i\"\n              [class.active]=\"themeManagerService.themeIndex === i\"\n              class=\"button button-styling theme-button {{ theme }}\">\n        \n      </button>\n    </div>\n\n    <div class=\"item-header\">Font Size</div>\n    <div class=\"button-row\">\n      <fa-icon (click)=\"onFontSizeUpdateClick(-1)\"\n               [icon]=\"faMinus\"\n               class=\"button button-styling icon-button\"></fa-icon>\n      <span class=\"label-button button-styling\">{{ ebookDisplayManagerService.fontSize$ | async }}px</span>\n      <fa-icon (click)=\"onFontSizeUpdateClick(1)\"\n               [icon]=\"faPlus\"\n               class=\"button button-styling icon-button\"></fa-icon>\n    </div>\n\n    <div class=\"item-header\">Blur Images (In case of spoiler)</div>\n    <div class=\"button-row\">\n    <span class=\"label-button button-styling clickable-button\"\n          (click)=\"onHideSpoilerImageClick()\"\n          [class.active]=\"ebookDisplayManagerService.hideSpoilerImage$ | async\">ON</span>\n    </div>\n\n    <div class=\"item-header\">Hide furigana</div>\n    <div class=\"button-row\">\n    <span class=\"label-button button-styling clickable-button\"\n          (click)=\"onHideFuriganaClick()\"\n          [class.active]=\"ebookDisplayManagerService.hideFurigana$ | async\">ON</span>\n    </div>\n  </div>\n  <footer class=\"dialog-footer\">\n    <button (click)=\"closeClick.emit()\" class=\"button label-button button-styling\" type=\"button\">Close</button>\n  </footer>\n</div>\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport * as zip from '@zip.js/zip.js';\nimport * as parser from 'fast-xml-parser';\nimport path from 'path-browserify';\nimport { UAParser } from 'ua-parser-js';\nimport { EpubContents } from './epub-types';\n\nconst parseResult = new UAParser(window.navigator.userAgent).getResult();\nconst isKiwiBrowser = parseResult.os.name === 'Android' && parseResult.browser.name === 'Chrome';\nzip.configure({\n  useWebWorkers: !isKiwiBrowser,\n});\n\nexport class HtmlzExtractor {\n\n  async extract(blob: Blob) {\n    const reader = new zip.ZipReader(new zip.BlobReader(blob));\n    // get all entries from the zip\n    const entries = await reader.getEntries();\n\n    const result: Record<string, string | Blob> = {};\n    if (entries.length) {\n      await Promise.all(\n        entries.map(async (entry) => {\n          if (entry.getData && !entry.directory) {\n            let value: string | Blob;\n            switch (entry.filename) {\n              case 'index.html':\n              case 'metadata.opf':\n              case 'style.css':\n                value = await entry.getData(new zip.TextWriter());\n                break;\n              default: {\n                value = await entry.getData(new zip.BlobWriter(getMimeTypeFromName(entry.filename)));\n              }\n            }\n            result[entry.filename] = value;\n          }\n        }),\n      );\n    }\n\n    // close the ZipReader\n    await reader.close();\n    return result;\n  }\n\n}\n\nexport class EpubExtractor {\n\n  async extract(blob: Blob) {\n    const reader = new zip.ZipReader(new zip.BlobReader(blob));\n    // get all entries from the zip\n    const entries = await reader.getEntries();\n\n    const result: Record<string, string | Blob> = {};\n    let contentsDirectory = '';\n    let contents!: EpubContents;\n    if (entries.length) {\n      const fileMap = entries.reduce<Record<string, zip.Entry>>((acc, cur) => {\n        acc[cur.filename] = cur;\n        return acc;\n      }, {});\n\n      // tslint:disable-next-line:no-non-null-assertion\n      const containerXml = await fileMap['META-INF/container.xml'].getData!(new zip.TextWriter());\n      const container = parser.parse(containerXml, {\n        ignoreAttributes: false,\n      });\n      const rootFiles = container.container.rootfiles.rootfile;\n      const rootFile = Array.isArray(rootFiles) ? rootFiles[0] : rootFiles;\n\n      const contentOpfFilename = rootFile['@_full-path'];\n      // tslint:disable-next-line:no-non-null-assertion\n      const contentsXml = await fileMap[contentOpfFilename].getData!(new zip.TextWriter());\n      result[contentOpfFilename] = contentsXml;\n\n      contentsDirectory = path.dirname(contentOpfFilename);\n\n      contents = parser.parse(contentsXml, {\n        ignoreAttributes: false,\n      });\n\n      await Promise.all(\n        contents.package.manifest.item.map(async (item) => {\n          const fileRelativePath = item['@_href'];\n          const entry = fileMap[path.join(contentsDirectory, fileRelativePath)];\n          if (entry.getData && !entry.directory) {\n            let value: string | Blob;\n            const mediaType: string = item['@_media-type'];\n            if (mediaType.startsWith('image/')) {\n              value = await entry.getData(new zip.BlobWriter(mediaType));\n            } else {\n              value = await entry.getData(new zip.TextWriter());\n            }\n            result[fileRelativePath] = value;\n          }\n        })\n      );\n    }\n\n    await reader.close();\n    return {\n      contentsDirectory,\n      contents,\n      result,\n    };\n  }\n\n}\n\n\nfunction getMimeTypeFromName(filename: string): string | undefined {\n  // image/gif, image/png, image/jpeg, image/bmp, image/webp\n  const regexResult = /.*\\.([^.]+)$/.exec(filename);\n  if (regexResult) {\n    switch (regexResult[1].toLowerCase()) {\n      case 'gif':\n        return 'image/gif';\n      case 'png':\n        return 'image/png';\n      case 'jpg':\n      case 'jpeg':\n      case 'jfif':\n      case 'jfi':\n        return 'image/jpeg';\n      case 'bmp':\n        return 'image/bmp';\n      case 'webp':\n        return 'image/webp';\n    }\n  }\n  return undefined;\n}\n","// @ts-nocheck\n/* tslint:disable */\n/**\n * Based on css parser/compiler by NxChg\n * https://github.com/NxtChg/pieces/tree/master/js/css_parser\n */\n\n\n// Dependencies\n// =============================================================================\nimport balanced from 'balanced-match';\n\n\n// Functions\n// =============================================================================\n/**\n * Parses CSS string and generates AST object\n *\n * @param {string}  css The CSS stringt to be converted to an AST\n * @param {object}  [options] Options object\n * @param {boolean} [options.preserveStatic=true] Determines if CSS\n *                  declarations that do not reference a custom property will\n *                  be preserved in the transformed CSS\n * @param {boolean} [options.removeComments=false] Remove comments from returned\n *                  object\n * @returns {object}\n */\nfunction parseCss(css, options = {}) {\n  const defaults = {\n    preserveStatic: true,\n    removeComments: false\n  };\n  const settings = Object.assign({}, defaults, options);\n  const errors   = [];\n\n  // Errors\n  // -------------------------------------------------------------------------\n  function error(msg) {\n    throw new Error(`CSS parse error: ${msg}`);\n  }\n\n  // RegEx\n  // -------------------------------------------------------------------------\n  // Match regexp and return captures\n  function match(re) {\n    const m = re.exec(css);\n\n    if (m) {\n      css = css.slice(m[0].length);\n\n      return m;\n    }\n  }\n\n  function open() {\n    return match(/^{\\s*/);\n  }\n\n  function close() {\n    return match(/^}/);\n  }\n\n  function whitespace() {\n    match(/^\\s*/);\n  }\n\n  // Comments\n  // -------------------------------------------------------------------------\n  function comment() {\n    whitespace();\n\n    if (css[0] !== '/' || css[1] !== '*') {\n      return;\n    }\n\n    let i = 2;\n\n    while (css[i] && (css[i] !== '*' || css[i + 1] !== '/')) {\n      i++;\n    }\n\n    if (!css[i]) {\n      return error('end of comment is missing');\n    }\n\n    const str = css.slice(2, i);\n\n    css = css.slice(i + 2);\n\n    return {\n      type   : 'comment',\n      comment: str\n    };\n  }\n\n  function comments() {\n    const cmnts = [];\n    let c;\n\n    while ((c = comment())) {\n      cmnts.push(c);\n    }\n\n    return settings.removeComments ? [] : cmnts;\n  }\n\n  // Selector\n  // -------------------------------------------------------------------------\n  function selector() {\n    whitespace();\n\n    while (css[0] === '}') {\n      error('extra closing bracket');\n    }\n\n    const m = match(/^((\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'|[^{])+)/);\n\n    if (m) {\n      return m[0]\n        .trim() // remove all comments from selectors\n        .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\n        .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function(m) {\n          return m.replace(/,/g, '\\u200C');\n        })\n        .split(/\\s*(?![^(]*\\)),\\s*/)\n        .map(function(s) {\n          return s.replace(/\\u200C/g, ',');\n        });\n    }\n  }\n\n  // Declarations\n  // -------------------------------------------------------------------------\n  function declaration() {\n    // Nested @ rule(s)\n    if (css[0] === '@') {\n      return at_rule();\n    }\n\n    match(/^([;\\s]*)+/); // ignore empty declarations + whitespace\n\n    const comment_regexp = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\n    let prop = match(/^(\\*?[-#/*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\n\n    if (!prop) {\n      return;\n    }\n\n    prop = prop[0].trim();\n\n    if (!match(/^:\\s*/)) {\n      return error('property missing \\':\\'');\n    }\n\n    // Quotes regex repeats verbatim inside and outside parentheses\n    const val = match(/^((?:\\/\\*.*?\\*\\/|'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\((\\s*'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|[^)]*?)\\s*\\)|[^};])+)/);\n    const ret = {\n      type    : 'declaration',\n      property: prop.replace(comment_regexp, ''),\n      value   : val ? val[0].replace(comment_regexp, '').trim() : ''\n    };\n\n    match(/^[;\\s]*/);\n\n    return ret;\n  }\n\n  function declarations() {\n    if (!open()) {\n      return error('missing \\'{\\'');\n    }\n\n    let d;\n    let decls = comments();\n\n    while ((d = declaration())) {\n      decls.push(d);\n      decls = decls.concat(comments());\n    }\n\n    if (!close()) {\n      return error('missing \\'}\\'');\n    }\n\n    return decls;\n  }\n\n  // Keyframes\n  // -------------------------------------------------------------------------\n  function keyframe() {\n    whitespace();\n\n    const vals = [];\n    let m;\n\n    while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\n      vals.push(m[1]);\n      match(/^,\\s*/);\n    }\n\n    if (vals.length) {\n      return {\n        type        : 'keyframe',\n        values      : vals,\n        declarations: declarations()\n      };\n    }\n  }\n\n  function at_keyframes() {\n    let m = match(/^@([-\\w]+)?keyframes\\s*/);\n\n    if (!m) {\n      return;\n    }\n\n    const vendor = m[1];\n\n    m = match(/^([-\\w]+)\\s*/);\n\n    if (!m) {\n      return error('@keyframes missing name');\n    }\n\n    const name = m[1];\n\n    if (!open()) {\n      return error('@keyframes missing \\'{\\'');\n    }\n\n    let frame;\n    let frames = comments();\n\n    while ((frame = keyframe())) {\n      frames.push(frame);\n      frames = frames.concat(comments());\n    }\n\n    if (!close()) {\n      return error('@keyframes missing \\'}\\'');\n    }\n\n    return {\n      type     : 'keyframes',\n      name     : name,\n      vendor   : vendor,\n      keyframes: frames\n    };\n  }\n\n  // @ Rules\n  // -------------------------------------------------------------------------\n  function at_page() {\n    const m = match(/^@page */);\n    if (m) {\n      const sel = selector() || [];\n      return { type: 'page', selectors: sel, declarations: declarations() };\n    }\n  }\n  function at_page_margin_box() {\n    const m = match(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\\s*/);\n    if (m) {\n      const name = `${m[1]}-${m[2]}` + (m[3] ? `-${m[3]}` : '');\n      return { type: 'page-margin-box', name, declarations: declarations() };\n    }\n  }\n  function at_fontface() {\n    const m = match(/^@font-face\\s*/);\n    if (m) { return { type: 'font-face', declarations: declarations() }; }\n  }\n  function at_supports() {\n    const m = match(/^@supports *([^{]+)/);\n    if (m) { return { type: 'supports', supports: m[1].trim(), rules: rules() }; }\n  }\n  function at_host() {\n    const m = match(/^@host\\s*/);\n    if (m) { return { type: 'host', rules: rules() }; }\n  }\n  function at_media() {\n    const m = match(/^@media([^{]+)*/);\n    if (m) { return { type: 'media', media: (m[1] || '').trim(), rules: rules() }; }\n  }\n  function at_custom_m() {\n    const m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\n    if (m) { return { type: 'custom-media', name: m[1].trim(), media: m[2].trim() }; }\n  }\n  function at_document() {\n    const m = match(/^@([-\\w]+)?document *([^{]+)/);\n    if (m) { return { type: 'document', document: m[2].trim(), vendor: m[1] ? m[1].trim() : null, rules: rules() }; }\n  }\n  function at_x() {\n    const m = match(/^@(import|charset|namespace)\\s*([^;]+);/);\n    if (m) { return { type: m[1], name: m[2].trim() }; }\n  }\n  function at_rule() {\n    whitespace();\n\n    if (css[0] === '@') {\n      const ret =\n        at_x() ||\n        at_fontface() ||\n        at_media() ||\n        at_keyframes() ||\n        at_supports() ||\n        at_document() ||\n        at_custom_m() ||\n        at_host() ||\n        at_page() ||\n        at_page_margin_box(); // Must be last\n\n      if (ret && !settings.preserveStatic) {\n        let hasVarFunc = false;\n\n        // @page, @font-face\n        if (ret.declarations) {\n          hasVarFunc = ret.declarations.some(decl => /var\\(/.test(decl.value));\n        }\n        // @keyframes, @media, @supports, etc.\n        else {\n          const arr = ret.keyframes || ret.rules || [];\n\n          hasVarFunc = arr.some(obj => (obj.declarations || []).some(decl => /var\\(/.test(decl.value)));\n        }\n\n        return hasVarFunc ? ret : {};\n      }\n\n      return ret;\n    }\n  }\n\n  // Rules\n  // -------------------------------------------------------------------------\n  function rule() {\n    if (!settings.preserveStatic) {\n      const balancedMatch = balanced('{', '}', css);\n\n      // Skip rulset if it does not contain a root/host variable\n      // declaration or a variable function value\n      if (balancedMatch) {\n        const hasVarDecl = /:(?:root|host)(?![.:#(])/.test(balancedMatch.pre) && /--\\S*\\s*:/.test(balancedMatch.body);\n        const hasVarFunc = /var\\(/.test(balancedMatch.body);\n\n        if (!hasVarDecl && !hasVarFunc) {\n          css = css.slice(balancedMatch.end + 1);\n\n          return {};\n        }\n      }\n    }\n\n    const sel   = selector() || [];\n    const decls = settings.preserveStatic ? declarations() : declarations().filter(decl => {\n      const hasVarDecl = sel.some(s => /:(?:root|host)(?![.:#(])/.test(s)) && /^--\\S/.test(decl.property);\n      const hasVarFunc = /var\\(/.test(decl.value);\n\n      return hasVarDecl || hasVarFunc;\n    });\n\n    if (!sel.length) {\n      error('selector missing');\n    }\n\n    return {\n      type        : 'rule',\n      selectors   : sel,\n      declarations: decls\n    };\n  }\n\n  function rules(core) {\n    if (!core && !open()) {\n      return error('missing \\'{\\'');\n    }\n\n    let node;\n    let rules = comments();\n\n    while (css.length && (core || css[0] !== '}') && (node = at_rule() || rule())) {\n      if (node.type) {\n        rules.push(node);\n      }\n\n      rules = rules.concat(comments());\n    }\n\n    if (!core && !close()) {\n      return error('missing \\'}\\'');\n    }\n\n    return rules;\n  }\n\n  return {\n    type: 'stylesheet',\n    stylesheet: {\n      rules: rules(true),\n      errors: errors\n    }\n  };\n}\n\n\n// Exports\n// =============================================================================\nexport default parseCss;\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Component, NgZone, OnInit } from '@angular/core';\nimport { ActivatedRoute, NavigationEnd, Router } from '@angular/router';\nimport { SwUpdate } from '@angular/service-worker';\nimport { faBookmark } from '@fortawesome/free-regular-svg-icons/faBookmark';\nimport { faCog } from '@fortawesome/free-solid-svg-icons/faCog';\nimport { faExpand } from '@fortawesome/free-solid-svg-icons/faExpand';\nimport { faFileMedical } from '@fortawesome/free-solid-svg-icons/faFileMedical';\nimport { faFolderPlus } from '@fortawesome/free-solid-svg-icons/faFolderPlus';\nimport { faSyncAlt } from '@fortawesome/free-solid-svg-icons/faSyncAlt';\nimport * as parser from 'fast-xml-parser';\nimport { IDBPDatabase } from 'idb';\nimport { fromEvent, of } from 'rxjs';\nimport { filter, map, shareReplay, switchMap, take, withLatestFrom } from 'rxjs/operators';\nimport { AutoScrollerService } from './auto-scroller.service';\nimport { BookmarkManagerService } from './bookmark-manager.service';\nimport { BooksDb, DatabaseService } from './database.service';\nimport { EbookDisplayManagerService } from './ebook-display-manager.service';\nimport { ScrollInformationService } from './scroll-information.service';\nimport { ThemeManagerService } from './theme-manager.service';\nimport parseCss from './utils/css-parser';\nimport stringifyCss from './utils/css-stringify';\nimport { EpubExtractor, HtmlzExtractor } from './utils/extractor';\nimport { getFormattedElementEpub, getFormattedElementHtmlz } from './utils/html-fixer';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnInit {\n\n  visible$ = this.router.events.pipe(\n    filter((event) => event instanceof NavigationEnd),\n    switchMap(() => {\n      if (this.route.firstChild) {\n        return this.route.firstChild.paramMap.pipe(\n          map((paramMap) => paramMap.has('identifier'))\n        );\n      }\n      return of(false);\n    }),\n    shareReplay(1),\n  );\n  loadingDb = true;\n  isMobileDevice = this.isMobile();\n  supportsFullScreen = this.fullscreenEnabled();\n  dropZoneLabel = this.isMobileDevice ?\n    'Select supported files (.htmlz or .epub) to continue' :\n    'Drop or select files (.htmlz or .epub) or a folder that contains those files to continue';\n  dropzoneHighlight = false;\n  showSettingsDialog = false;\n  faFileMedical = faFileMedical;\n  faFolderPlus = faFolderPlus;\n  faCog = faCog;\n  faBookmark = faBookmark;\n  faSyncAlt = faSyncAlt;\n  faExpand = faExpand;\n  isUpdateAvailable = false;\n  filePattern = /\\.(?:htmlz|epub)$/;\n\n  constructor(\n    public autoScrollerService: AutoScrollerService,\n    public bookmarManagerService: BookmarkManagerService,\n    public ebookDisplayManagerService: EbookDisplayManagerService,\n    private scrollInformationService: ScrollInformationService,\n    private themeManagerService: ThemeManagerService,\n    private databaseService: DatabaseService,\n    private router: Router,\n    private route: ActivatedRoute,\n    private zone: NgZone,\n    updates: SwUpdate,\n  ) {\n    updates.available.subscribe(() => {\n      this.isUpdateAvailable = true;\n    });\n  }\n\n  ngOnInit(): void {\n    fromEvent<DragEvent>(document.body, 'dragenter').subscribe((ev) => this.onDragEnter(ev));\n    fromEvent<DragEvent>(document.body, 'dragover').subscribe((ev) => this.onDragOver(ev));\n    fromEvent<DragEvent>(document.body, 'dragend').subscribe((ev) => this.onDragEnd(ev));\n    fromEvent<DragEvent>(document.body, 'drop').pipe(\n      withLatestFrom(this.ebookDisplayManagerService.loadingFiles$)).subscribe(([ev, loadingFiles$]) => {\n        ev.preventDefault();\n        if (!loadingFiles$) {\n          this.onDrop(ev);\n        }\n      });\n    fromEvent<KeyboardEvent>(window, 'keydown').pipe(\n      withLatestFrom(this.ebookDisplayManagerService.loadingFile$, this.visible$),\n    ).subscribe(([ev, loadingFile, visible]) => {\n      if (!loadingFile && visible) {\n        switch (ev.code) {\n          case 'Escape':\n            this.setShowSettingsDialog(false);\n            break;\n          case 'Space':\n            this.autoScrollerService.toggle();\n            ev.preventDefault();\n            break;\n          case 'KeyA':\n            this.autoScrollerService.increaseSpeed();\n            break;\n          case 'KeyD':\n            this.autoScrollerService.decreaseSpeed();\n            break;\n          case 'KeyB':\n            this.bookmarManagerService.saveScrollPosition();\n            break;\n          case 'PageDown':\n            window.scrollBy({\n              left: window.innerWidth * -.9,\n              behavior: 'smooth',\n            });\n            break;\n          case 'PageUp':\n            window.scrollBy({\n              left: window.innerWidth * .9,\n              behavior: 'smooth',\n            });\n            break;\n        }\n      }\n    });\n\n    this.databaseService.db.then((db) => {\n      this.visible$.pipe(\n        take(1),\n      ).subscribe(async (visible) => {\n        if (!visible) {\n          const lastItem = await db.get('lastItem', 0);\n          if (lastItem) {\n            this.ebookDisplayManagerService.loadingFile$.next(true); // otherwise may get NG0100 (if modified while init ReaderComponent)\n            await this.router.navigate(['b', lastItem.dataId]);\n          }\n        }\n        this.loadingDb = false;\n      });\n    });\n  }\n\n  isMobile() {\n    if ('maxTouchPoints' in window.navigator as any) {\n      return 0 < window.navigator.maxTouchPoints;\n    }\n\n    if ('msMaxTouchPoints' in window.navigator as any) {\n      return 0 < window.navigator.msMaxTouchPoints;\n    }\n\n    const mQ = window.matchMedia?.('(pointer:coarse)');\n    if (mQ?.media === '(pointer: coarse)') {\n      return mQ.matches;\n    }\n\n    if ('orientation' in window) {\n      return true;\n    }\n\n    const UA = window.navigator.userAgent;\n    const userAgentRegex = /\\b(BlackBerry|webOS|iPhone|IEMobile|Android|Windows Phone|iPad|iPod)\\b/i;\n    return userAgentRegex.test(UA);\n  }\n\n  onInputChange(el: HTMLInputElement) {\n    if (el.files?.length) {\n      const validFiles = Array.from(el.files).filter((file) => this.filePattern.test(file.name));\n\n      if (validFiles.length) {\n        this.onFileChange(validFiles);\n      } else {\n        alert('Only .htmlz and .epub Files are supported');\n      }\n    }\n  }\n\n  setShowSettingsDialog(b: boolean) {\n    this.showSettingsDialog = b;\n    this.ebookDisplayManagerService.allowScroll = !b;\n    if (b) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.removeProperty('overflow');\n    }\n  }\n\n  fullscreenEnabled() {\n    return document.fullscreenEnabled ?? false;\n  }\n\n  toggleFullscreen() {\n    if (!document.fullscreenElement) {\n      document.documentElement.requestFullscreen();\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      }\n    }\n  }\n\n  onDrop(ev: DragEvent) {\n    this.dropzoneHighlight = false;\n\n    if (!ev?.dataTransfer?.items) {\n      return;\n    }\n\n    const items = [];\n\n    for (const item of ev.dataTransfer.items) {\n      if ('file' !== item.kind) {\n        continue;\n      }\n\n      items.push(item.webkitGetAsEntry());\n    }\n\n    if (items.length) {\n      this.handleDropResult(items);\n    }\n  }\n\n  async handleDropResult(items: any[]) {\n    const addFilesFromDirectory = async (entry: any, fileMap: Map<string, File>): Promise<void> => {\n      if (entry.isDirectory) {\n        const dirReader = entry.createReader();\n\n        const entries = await new Promise<any>(async (resolve) => {\n          const allEntries = [];\n          let dirEntries = await new Promise<any>((innerResolve) => dirReader.readEntries(innerResolve)).catch(() => []);\n\n          while (dirEntries.length) {\n            allEntries.push(...dirEntries);\n            dirEntries = await new Promise<any>((innerResolve) => dirReader.readEntries(innerResolve)).catch(() => []);\n          }\n          resolve(allEntries);\n        }).catch(() => []);\n        for (let index = 0, length = entries.length; index < length; index++) {\n          await addFilesFromDirectory(entries[index], fileMap).catch(() => { });\n        }\n      } else {\n        const file = await new Promise<File>((resolve) => entry.file(resolve)).catch(() => { });\n\n        if (file && this.filePattern.test(file.name)) {\n          fileMap.set(file.name, file);\n        }\n      }\n    };\n\n    const files = new Map<string, File>();\n\n    for (let index = 0, length = items.length; index < length; index++) {\n      const entry = items[index];\n\n      if (entry.isDirectory) {\n        await addFilesFromDirectory(entry, files);\n      } else if (this.filePattern.test(entry.name)) {\n\n        const file = await new Promise<File>((resolve) => entry.file(resolve)).catch(() => { });\n        if (file) {\n          files.set(file.name, file);\n        }\n      }\n    }\n\n    if (!files.size) {\n      return alert('Only .htmlz and .epub Files are supported');\n    }\n\n    this.onFileChange(Array.from(files.values()));\n  }\n\n  onDragEnter(ev: DragEvent) {\n    ev.preventDefault();\n    this.dropzoneHighlight = true;\n  }\n\n  onDragOver(ev: DragEvent) {\n    ev.preventDefault();\n    this.dropzoneHighlight = true;\n  }\n\n  onDragEnd(ev: DragEvent) {\n    ev.preventDefault();\n    this.dropzoneHighlight = false;\n  }\n\n  private async onFileChange(files: Array<File>) {\n    const multiFiles = 1 < files.length;\n\n    let dataId = 0;\n    let importFailures = 0;\n\n    this.autoScrollerService.stop();\n\n    if (!multiFiles) {\n      this.ebookDisplayManagerService.loadingFile$.next(true);\n    }\n\n    const db = await this.databaseService.db.catch(() => {\n      if (!multiFiles) {\n        this.ebookDisplayManagerService.loadingFile$.next(false);\n      }\n      return undefined;\n    });\n\n    if (!db) {\n      return alert('Failure accessing Database');\n    }\n\n    for (let index = 0, length = files.length; index < length; index++) {\n      const file = files[index];\n\n      if (multiFiles) {\n        this.ebookDisplayManagerService.loadingFiles$.next({\n          title: file.name,\n          progress: `${Math.round(index / length * 100)}%`\n        });\n      }\n\n      const lastDataId = await this.storeFileInDB(db, file);\n\n      if (lastDataId) {\n        dataId = lastDataId;\n      } else {\n        importFailures++;\n      }\n    }\n\n    if (importFailures) {\n      alert(`${importFailures} Import(s) failed`);\n    }\n\n    if (multiFiles) {\n      this.ebookDisplayManagerService.loadingFiles$.next(undefined);\n    }\n\n    if (!dataId) {\n      if (!multiFiles) {\n        this.ebookDisplayManagerService.loadingFile$.next(false);\n      }\n\n      return;\n    }\n\n    void db.put('lastItem', {\n      dataId,\n    }, 0).catch(() => { });\n    await this.zone.run(async () => {\n      this.ebookDisplayManagerService.loadingFile$.next(true);\n      const changedIdentifier = await this.router.navigate(['b', dataId]);\n      if (!changedIdentifier) {\n        this.ebookDisplayManagerService.revalidateFile.next();\n      }\n    }).catch(() => this.ebookDisplayManagerService.loadingFile$.next(false));\n  }\n\n  private storeFileInDB(db: IDBPDatabase<BooksDb>, file: File): Promise<number | undefined> {\n    return this.zone.runOutsideAngular(async () => {\n      try {\n        const storeData = file.name.endsWith('.epub') ? await processEpub(file) : await processHtmlz(file);\n        let dataId: number;\n        {\n          const tx = db.transaction('data', 'readwrite');\n          const store = tx.store;\n          const oldId = await store.index('title').getKey(storeData.title);\n\n          if (oldId) {\n            dataId = await store.put({\n              ...storeData,\n              id: oldId,\n            });\n          } else {\n            dataId = await store.add(storeData);\n          }\n          await tx.done;\n          return dataId;\n        }\n      } catch (ex) {\n        console.error(`${file.name}: ${ex.message}`);\n        return undefined;\n      }\n    });\n  }\n}\n\nconst htmlzExtractor = new HtmlzExtractor();\nasync function processHtmlz(file: File) {\n  const data = await htmlzExtractor.extract(file);\n  const element = getFormattedElementHtmlz(data);\n  const metadata = parser.parse(data['metadata.opf'] as string)?.package?.metadata;\n  const displayData = {\n    title: file.name,\n    styleSheet: fixStyleString(data['style.css'] as string),\n  };\n  if (metadata && metadata['dc:title']) {\n    displayData.title = metadata['dc:title'];\n  }\n  const blobData = Object.entries(data)\n    .filter((d): d is [string, Blob] => d[1] instanceof Blob)\n    .reduce<Record<string, Blob>>((acc, [k, v]) => {\n      acc[k] = v;\n      return acc;\n    }, {});\n  const blobDataWithoutCoverImage = {\n    ...blobData,\n  };\n  delete blobDataWithoutCoverImage['cover.jpg'];\n  const storeData: BooksDb['data']['value'] = {\n    ...displayData,\n    elementHtml: element.innerHTML,\n    blobs: blobDataWithoutCoverImage,\n    coverImage: blobData['cover.jpg'],\n  };\n  return storeData;\n}\n\nconst epubExtractor = new EpubExtractor();\nasync function processEpub(file: File) {\n  const {\n    contents,\n    result: data,\n  } = await epubExtractor.extract(file);\n  const element = getFormattedElementEpub(data, contents);\n\n  let styleSheet = '';\n\n  const cssFiles = contents.package.manifest.item\n    .filter((item) => item['@_media-type'] === 'text/css')\n    .map((item) => item['@_href']);\n\n  if (cssFiles.length) {\n    const cssPathsUnique = new Set(cssFiles);\n\n    let combinedDirtyStyleString = '';\n    for (const mainCssFilename of cssPathsUnique) {\n      combinedDirtyStyleString += data[mainCssFilename] as string;\n    }\n\n    if (combinedDirtyStyleString) {\n      styleSheet = fixStyleString(combinedDirtyStyleString);\n    }\n  }\n  const displayData = {\n    title: file.name,\n    styleSheet,\n  };\n\n  const metadata = contents.package.metadata;\n  if (metadata) {\n    const dcTitle = metadata['dc:title'];\n    if (typeof dcTitle === 'string') {\n      displayData.title = dcTitle;\n    } else if (dcTitle && dcTitle['#text']) {\n      displayData.title = dcTitle['#text'];\n    }\n  }\n  const blobData = Object.entries(data)\n    .filter((d): d is [string, Blob] => d[1] instanceof Blob)\n    .reduce<Record<string, Blob>>((acc, [k, v]) => {\n      acc[k] = v;\n      return acc;\n    }, {});\n\n  let coverImageFilename = 'cover.jpeg';\n\n  const coverDataItem = contents.package.manifest.item\n    .find((item) => item['@_id'] === 'cover' && item['@_media-type'].startsWith('image/'));\n  if (coverDataItem) {\n    coverImageFilename = coverDataItem['@_href'];\n  }\n\n  const storeData: BooksDb['data']['value'] = {\n    ...displayData,\n    elementHtml: element.innerHTML,\n    blobs: blobData,\n    coverImage: blobData[coverImageFilename],\n  };\n  return storeData;\n}\n\nfunction fixStyleString(styleString: string): string {\n  const cssAst = parseCss(styleString);\n\n  let newRules: {\n    type: string;\n    selectors?: string[];\n    declarations?: any[];\n  }[] = [];\n  if (cssAst.stylesheet.rules) {\n    for (const rule of cssAst.stylesheet.rules) {\n      if (rule.type === 'rule') {\n        newRules.push(rule);\n      }\n    }\n  }\n\n  newRules = newRules\n    .filter((rule) => rule.selectors\n      ? !rule.selectors.includes('html') && !rule.selectors.includes('body')\n      : true);\n\n  if (cssAst.stylesheet.rules) {\n    for (const rule of newRules) {\n      if (rule.declarations) {\n        const newDeclarations: { [key: string]: string } = {};\n        let hasLineBreakDefined: boolean | undefined;\n        for (const declaration of rule.declarations) {\n          if (declaration.type === 'declaration') {\n            {\n              const regexResult = /(?:(?:-epub-)|(?:-webkit-))(.+)/i.exec(declaration.property);\n              if (regexResult) {\n                newDeclarations[regexResult[1]] = declaration.value;\n              }\n            }\n\n            if (declaration.property === 'font-family') {\n              let newValue: string = declaration.value;\n              if (newValue.includes('sans-serif')) {\n                newValue = `var(--font-family-sans-serif,\"Noto Sans JP\",${newValue})`;\n              } else if (newValue.includes('serif')) {\n                newValue = `var(--font-family-serif,\"Noto Serif JP\",${newValue})`;\n              }\n              newDeclarations[declaration.property] = newValue;\n            }\n\n            if (/(?:(?:-epub-)|(?:-webkit-))?word-break$/i.exec(declaration.property) && declaration.value === 'break-all') {\n              if (hasLineBreakDefined === undefined) {\n                hasLineBreakDefined = rule.declarations.some((d) => d.type === 'declaration' && d.property === 'line-break');\n              }\n              if (!hasLineBreakDefined && !newDeclarations['line-break']) {\n                // to allow breaks one long string of periods\n                newDeclarations['line-break'] = 'loose';\n              }\n            }\n          }\n        }\n        for (const [property, value] of Object.entries(newDeclarations)) {\n          rule.declarations.push({\n            type: 'declaration',\n            property,\n            value,\n          });\n        }\n      }\n    }\n  }\n\n  return stringifyCss({\n    stylesheet: {\n      rules: newRules,\n    },\n    type: 'stylesheet',\n  });\n}\n","<router-outlet></router-outlet>\n\n<ng-container *ngIf=\"visible$ | async\">\n  <div *ngIf=\"autoScrollerService.activated\" class=\"top-overlay auto-mode-container\">\n    <span class=\"uppercase\">Auto</span> ({{ autoScrollerService.multiplier }}x)\n  </div>\n\n  <div class=\"top-overlay action-icon-container\">\n    <label class=\"no-margin\">\n      <fa-icon class=\"action-icon\"\n               [icon]=\"faFileMedical\"></fa-icon>\n      <input type=\"file\" accept=\".htmlz,.epub\" multiple (change)=\"onInputChange(inputRef)\" hidden #inputRef>\n    </label>\n    <label class=\"no-margin\" *ngIf=\"!isMobileDevice\">\n      <fa-icon class=\"action-icon margin-icon\"\n               [icon]=\"faFolderPlus\"></fa-icon>\n      <input type=\"file\" webkitdirectory directory multiple (change)=\"onInputChange(inputDirRef)\"\n        hidden #inputDirRef>\n    </label>\n    <fa-icon class=\"action-icon margin-icon\"\n             [icon]=\"faBookmark\"\n             (click)=\"bookmarManagerService.saveScrollPosition()\"></fa-icon>\n    <fa-icon class=\"action-icon margin-icon\"\n             [icon]=\"faCog\"\n             (click)=\"setShowSettingsDialog(true)\"></fa-icon>\n  </div>\n  <div class=\"top-overlay action-icon-container_left\">\n    <fa-icon class=\"action-icon margin-icon\" *ngIf=\"supportsFullScreen\"\n             [icon]=\"faExpand\"\n             (click)=\"toggleFullscreen()\"></fa-icon>\n  </div>\n</ng-container>\n\n<div class=\"overlay-container loading-container\"\n     *ngIf=\"loadingDb || (ebookDisplayManagerService.loadingFile$ | async); else notLoadingRef\">\n  Loading...\n</div>\n\n<div class=\"overlay-container loading-container drop-zone-container darker\"\n     *ngIf=\"(ebookDisplayManagerService.loadingFiles$ | async)\">\n  <div class=\"progress-container\">\n    <div class=\"truncate\">{{ebookDisplayManagerService.loadingFiles$.value?.title}}</div>\n    <div class=\"progress\">\n      <span [style.width]=\"ebookDisplayManagerService.loadingFiles$.value?.progress\"></span>\n    </div>\n  </div>\n</div>\n\n<ng-template #notLoadingRef>\n  <label class=\"overlay-container drop-zone-container label-button\" *ngIf=\"!(visible$ | async)\" (click)=\"zoneInputRef.click();\"\n    (contextmenu)=\"$event.preventDefault();zoneInputDirRef.click();\">\n    {{dropZoneLabel}}\n  </label>\n  <input type=\"file\" accept=\".htmlz,.epub\" multiple hidden #zoneInputRef (change)=\"onInputChange(zoneInputRef)\">\n  <input type=\"file\" webkitdirectory directory multiple hidden #zoneInputDirRef (change)=\"onInputChange(zoneInputDirRef)\">\n</ng-template>\n\n<div class=\"dialog-overlay\"\n     *ngIf=\"showSettingsDialog\"\n     (click)=\"setShowSettingsDialog(false)\">\n  <app-settings-dialog class=\"settings-dialog\"\n                       (closeClick)=\"setShowSettingsDialog(false)\"\n                       (click)=\"$event.stopPropagation()\"></app-settings-dialog>\n</div>\n\n<fa-icon *ngIf=\"isUpdateAvailable\"\n         [icon]=\"faSyncAlt\"\n         class=\"information-overlay bottom-overlay update-ready-icon\"></fa-icon>\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { NgModule } from '@angular/core';\nimport { ServiceWorkerModule } from '@angular/service-worker';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { ReaderComponent } from './reader/reader.component';\nimport { SettingsDialogComponent } from './settings-dialog/settings-dialog.component';\nimport { environment } from '../environments/environment';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    ReaderComponent,\n    SettingsDialogComponent,\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    FontAwesomeModule,\n    ServiceWorkerModule.register('ngsw-worker.js', {\n      enabled: environment.production,\n      // Register the ServiceWorker as soon as the app is stable\n      // or after 30 seconds (whichever comes first).\n      registrationStrategy: 'registerWhenStable:30000'\n    }),\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Injectable } from '@angular/core';\nimport { DBSchema, IDBPDatabase, IDBPTransaction, openDB } from 'idb';\n\ninterface BooksDbV2 extends DBSchema {\n  keyvaluepairs: {\n    key: string;\n    value: string;\n  };\n  'local-forage-detect-blob-support': {\n    key: any;\n    value: any;\n  };\n}\n\ninterface BooksDbV3 extends DBSchema {\n  data: {\n    key: number;\n    value: {\n      id?: number;\n      title: string;\n      styleSheet: string;\n      elementHtml: string;\n      blobs: Record<string, Blob>;\n      coverImage?: Blob;\n    };\n    indexes: {\n      title: string;\n    };\n  };\n  bookmark: {\n    key: number;\n    value: {\n      dataId: number;\n      scrollX: number;\n      exploredCharCount?: number;\n    };\n    indexes: {\n      dataId: number;\n    };\n  };\n  lastItem: {\n    key: number;\n    value: {\n      dataId: number;\n    };\n  };\n}\n\nexport type BooksDb = BooksDbV3;\n\nconst db = openDB<BooksDb>('books', 3, {\n  async upgrade(oldDb, oldVersion, newVersion, transaction) {\n    switch (oldVersion) {\n      case 0: {\n        const dataStore = oldDb.createObjectStore('data', {\n          keyPath: 'id',\n          autoIncrement: true,\n        });\n        dataStore.createIndex('title', 'title');\n\n        oldDb.createObjectStore('bookmark', {\n          keyPath: 'dataId',\n        });\n\n        oldDb.createObjectStore('lastItem');\n        break;\n      }\n      case 2: {\n        const dataStore = oldDb.createObjectStore('data', {\n          keyPath: 'id',\n          autoIncrement: true,\n        });\n        dataStore.createIndex('title', 'title');\n\n        oldDb.createObjectStore('bookmark', {\n          keyPath: 'dataId',\n        });\n\n        oldDb.createObjectStore('lastItem');\n\n        const oldDbV2 = (oldDb as unknown) as IDBPDatabase<BooksDbV2>;\n        const transactionV2 = (transaction as unknown) as IDBPTransaction<BooksDbV2>;\n\n        const oldValues: {\n          data: Record<string, string>,\n          scrollX: Record<string, string>,\n          lastItem?: string,\n        } = {\n          data: {},\n          scrollX: {},\n        };\n        {\n          let cursor = await transactionV2.objectStore('keyvaluepairs').openCursor();\n          while (cursor) {\n            const regexResult = /([^\\-]+)-(.+)/.exec(cursor.key);\n            if (regexResult) {\n              switch (regexResult[1]) {\n                case 'data':\n                case 'scrollX':\n                  oldValues[regexResult[1]][regexResult[2]] = cursor.value;\n                  break;\n              }\n            } else if (cursor.key === 'lastItem') {\n              oldValues[cursor.key] = cursor.value;\n            }\n            cursor = await cursor.continue();\n          }\n        }\n\n        await Promise.all(\n          Object.entries(oldValues.data).map(async ([key, valueString]) => {\n            const parsedData = JSON.parse(valueString);\n            if (isFormattedDbV2Data(parsedData)) {\n              const dataId = await transaction.objectStore('data').add({\n                ...parsedData,\n                blobs: {},\n              });\n\n              const scrollX = oldValues.scrollX[key];\n              if (scrollX) {\n                await transaction.objectStore('bookmark').put({\n                  dataId,\n                  scrollX: +scrollX,\n                });\n              }\n\n              if (oldValues.lastItem === key) {\n                transaction.objectStore('lastItem').put({\n                  dataId,\n                }, 0);\n              }\n            }\n          })\n        );\n\n        oldDbV2.deleteObjectStore('keyvaluepairs');\n        oldDbV2.deleteObjectStore('local-forage-detect-blob-support');\n        break;\n      }\n    }\n  }\n});\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DatabaseService {\n\n  db = db;\n\n}\n\ninterface DbV2Data {\n  title: string;\n  elementHtml: string;\n  styleSheet: string;\n}\n\nfunction isFormattedDbV2Data(x: unknown): x is DbV2Data {\n  if (typeof x === 'object' && x) {\n    for (const key of ['title', 'elementHtml', 'styleSheet']) {\n      // @ts-ignore\n      if (!(key in x) || typeof x[key] !== 'string') {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// https://stackoverflow.com/a/47206289\nexport function SmoothScroll(target: HTMLElement, smooth: number) {\n  const scrollAxis = 'scrollLeft';\n\n  let moving = false;\n  let targetPos = target[scrollAxis];\n  let expectedPos = target[scrollAxis];\n\n  function update() {\n    moving = true;\n\n    const delta = Math.trunc((targetPos - target[scrollAxis]) / smooth);\n\n    if (target[scrollAxis] !== expectedPos) {\n      moving = false;\n    } else {\n      expectedPos += delta;\n      target.scrollBy(delta, 0);\n\n      if (Math.abs(delta) > 0) {\n        window.requestAnimationFrame(update);\n      } else {\n        moving = false;\n      }\n    }\n  }\n\n  return (delta: number) => {\n    if (!moving) {\n      targetPos = target[scrollAxis];\n      expectedPos = target[scrollAxis];\n    }\n\n    targetPos += delta;\n\n    if (!moving) {\n      update();\n    }\n  };\n}\n","// @ts-nocheck\n/* tslint:disable */\n/**\n * Based on css parser/compiler by NxChg\n * https://github.com/NxtChg/pieces/tree/master/js/css_parser\n */\n\n\n// Functions\n// =============================================================================\n/**\n * Compiles CSS AST to string\n *\n * @param {object}   tree CSS AST object\n * @param {string}   [delim=''] CSS rule delimiter\n * @param {function} cb Function to be called before each node is processed\n * @returns {string}\n */\nfunction stringifyCss(tree, delim = '', cb?: (x: any) => void) {\n  const renderMethods = {\n    charset(node) {\n      return '@charset ' + node.name + ';';\n    },\n    comment(node) {\n      // Preserve ponyfill marker comments\n      return node.comment.indexOf('__CSSVARSPONYFILL') === 0 ? '/*' + node.comment + '*/' : '';\n    },\n    'custom-media'(node) {\n      return '@custom-media ' + node.name + ' ' + node.media + ';';\n    },\n    declaration(node) {\n      return node.property + ':' + node.value + ';';\n    },\n    document(node) {\n      return '@' + (node.vendor || '') + 'document ' + node.document + '{' + visit(node.rules) + '}';\n    },\n    'font-face'(node) {\n      return '@font-face' + '{' + visit(node.declarations) + '}';\n    },\n    host(node) {\n      return '@host' + '{' + visit(node.rules) + '}';\n    },\n    import(node) {\n      // FIXED\n      return '@import ' + node.name + ';';\n    },\n    keyframe(node) {\n      return node.values.join(',') + '{' + visit(node.declarations) + '}';\n    },\n    keyframes(node) {\n      return '@' + (node.vendor || '') + 'keyframes ' + node.name + '{' + visit(node.keyframes) + '}';\n    },\n    media(node) {\n      return '@media ' + node.media + '{' + visit(node.rules) + '}';\n    },\n    namespace(node) {\n      return '@namespace ' + node.name + ';';\n    },\n    page(node) {\n      return '@page ' + (node.selectors.length ? node.selectors.join(', ') : '') + '{' + visit(node.declarations) + '}';\n    },\n    'page-margin-box'(node) {\n      return '@' + node.name + '{' + visit(node.declarations) + '}';\n    },\n    rule(node) {\n      const decls = node.declarations;\n\n      if (decls.length) {\n        return node.selectors.join(',') + '{' + visit(decls) + '}';\n      }\n    },\n    supports(node) {\n      // FIXED\n      return '@supports ' + node.supports + '{' + visit(node.rules) + '}';\n    }\n  };\n\n  function visit(nodes) {\n    let buf = '';\n\n    for (let i = 0; i < nodes.length; i++) {\n      const n = nodes[i];\n\n      if (cb) {\n        cb(n);\n      }\n\n      const txt = renderMethods[n.type](n);\n\n      if (txt) {\n        buf += txt;\n\n        if (txt.length && n.selectors) {\n          buf += delim;\n        }\n      }\n    }\n\n    return buf;\n  }\n\n  return visit(tree.stylesheet.rules);\n}\n\n\n// Exports\n// =============================================================================\nexport default stringifyCss;\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ThemeManagerService {\n  themeIndex = -1;\n\n  readonly availableThemes = [\n    'light-theme',\n    'gray-theme',\n    'dark-theme',\n    'ecru-theme',\n    'water-theme',\n  ];\n\n  constructor() {\n    const storedTheme = localStorage.getItem('theme');\n\n    if (storedTheme) {\n      this.themeIndex = this.availableThemes.findIndex((x) => x === storedTheme);\n    }\n\n    if (this.themeIndex < 0) {\n      this.themeIndex = 0;\n    }\n\n    document.documentElement.classList.add(this.availableThemes[this.themeIndex]);\n  }\n\n  setTheme(themeIndex: number) {\n    const previousTheme = this.availableThemes[this.themeIndex];\n    this.themeIndex = themeIndex;\n    const currentTheme = this.availableThemes[this.themeIndex];\n    document.documentElement.classList.replace(previousTheme, currentTheme);\n\n    localStorage.setItem('theme', currentTheme);\n  }\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Injectable } from '@angular/core';\nimport { DatabaseService } from './database.service';\nimport { ScrollInformationService } from './scroll-information.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class BookmarkManagerService {\n\n  identifier = NaN;\n  readonly el: HTMLElement;\n\n  constructor(\n    private databaseService: DatabaseService,\n    private scrollInformationService: ScrollInformationService,\n  ) {\n    this.el = document.createElement('div');\n    this.el.classList.add('bookmark-cover');\n    this.el.hidden = true;\n  }\n\n  async scrollToSavedPosition() {\n    const targetScrollX = await this.getBookmarkPosition();\n    if (targetScrollX !== undefined) {\n      window.scrollTo(targetScrollX, 0);\n      this.el.style.right = `${-targetScrollX}px`;\n      this.el.hidden = false;\n    }\n  }\n\n  async saveScrollPosition() {\n    const db = await this.databaseService.db;\n    void db.put('bookmark', {\n      dataId: this.identifier,\n      scrollX: window.scrollX,\n      exploredCharCount: this.scrollInformationService.exploredCharCount,\n    });\n    this.el.style.right = `${-window.scrollX}px`;\n    this.el.hidden = false;\n  }\n\n  async refreshBookmarkBarPosition() {\n    const targetScrollX = await this.getBookmarkPosition();\n    if (targetScrollX !== undefined) {\n      this.el.style.right = `${-targetScrollX}px`;\n    }\n  }\n\n  private async getBookmarkPosition() {\n    const db = await this.databaseService.db;\n    const bookmark = await db.get('bookmark', this.identifier);\n    if (bookmark) {\n      let targetScrollX: number;\n      if (bookmark.exploredCharCount) {\n        if (this.scrollInformationService.getCharCount(Math.abs(bookmark.scrollX)) === bookmark.exploredCharCount) {\n          targetScrollX = bookmark.scrollX;\n        } else {\n          targetScrollX = this.scrollInformationService.getScrollPos(bookmark.exploredCharCount);\n        }\n      } else {\n        targetScrollX = bookmark.scrollX;\n      }\n      return targetScrollX;\n    }\n    return undefined;\n  }\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { ReaderComponent } from './reader/reader.component';\n\nconst routes: Routes = [\n  {\n    path: 'b/:identifier',\n    component: ReaderComponent,\n  },\n  {\n    path: '**',\n    redirectTo: '',\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes, {\n    initialNavigation: 'enabled',\n    useHash: true,\n  })],\n  exports: [RouterModule],\n})\nexport class AppRoutingModule {\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Injectable, NgZone } from '@angular/core';\nimport { EbookDisplayManagerService } from './ebook-display-manager.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ScrollInformationService {\n  el = document.createElement('div');\n\n  /**\n   * Doesn't matter what's returned here, just placeholder\n   */\n  paragraphs: Iterable<HTMLElement> & { length: number } = [];\n\n  paragraphPos: number[] = Array(this.paragraphs.length);\n  charCount: number[] = Array(this.paragraphs.length);\n  exploredCharCount = 0;\n\n  constructor(private ebookDisplayManagerService: EbookDisplayManagerService, private zone: NgZone) {\n    this.el.classList.add('information-overlay', 'bottom-overlay', 'scroll-information');\n\n    this.zone.runOutsideAngular(() => {\n      let visible = true;\n      this.el.addEventListener('click', () => {\n        if (visible) {\n          this.el.style.opacity = '0';\n        } else {\n          this.el.style.removeProperty('opacity');\n        }\n        visible = !visible;\n      });\n    });\n  }\n\n  updateParagraphPos() {\n    this.paragraphPos = [];\n    this.charCount = [];\n    let exploredCharCount = 0;\n    for (const el of this.paragraphs) {\n      this.paragraphPos.push(document.documentElement.offsetWidth - el.offsetLeft);\n      exploredCharCount += this.ebookDisplayManagerService.getCharCount(el);\n      this.charCount.push(exploredCharCount);\n    }\n  }\n\n  initWatchParagraphs(el: HTMLElement) {\n    this.paragraphs = el.getElementsByTagName('p');\n\n    if (this.paragraphs.length === 0) {\n      const potentialParagraphs = Array.from(el.querySelectorAll( '*' ))\n        .filter( (p): p is HTMLElement => p instanceof HTMLElement\n          && !p.attributes.getNamedItem('aria-hidden')\n          && p.parentElement?.tagName !== 'RUBY')\n        .filter((p) => {\n          for (const pChild of p.childNodes) {\n            if (pChild.nodeType === Node.TEXT_NODE && pChild.textContent && pChild.textContent.trim().length > 0) {\n              return true;\n            }\n          }\n          return false;\n        });\n      const potentialParagraphsSet = new Set(potentialParagraphs);\n      // tslint:disable-next-line:no-non-null-assertion\n      this.paragraphs = potentialParagraphs.filter((p) => !potentialParagraphsSet.has(p.parentElement!));\n    }\n  }\n\n  calcExploredCharCount() {\n    const scrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft;\n    return this.getCharCount(Math.abs(scrollLeft));\n  }\n\n  updateScrollPercent(totalCharCount: number) {\n    this.exploredCharCount = this.calcExploredCharCount();\n    this.el.innerText = `${this.exploredCharCount}/${totalCharCount} (${((this.exploredCharCount / totalCharCount) * 100).toFixed(2)}%)`;\n  }\n\n  updateScrollPercentByCharCount(totalCharCount: number, charCount: number) {\n    this.exploredCharCount = charCount;\n    this.el.innerText = `${this.exploredCharCount}/${totalCharCount} (${((this.exploredCharCount / totalCharCount) * 100).toFixed(2)}%)`;\n  }\n\n  getCharCount(scrollPos: number) {\n    const index = binarySearch(this.paragraphPos, 0, this.paragraphPos.length - 1, scrollPos);\n    return this.charCount[index] || 0;\n  }\n\n  getScrollPos(charCount: number) {\n    const index = binarySearch(\n      this.charCount,\n      0,\n      this.charCount.length - 1,\n      charCount,\n    );\n    return -this.paragraphPos[index];\n  }\n}\n\nfunction binarySearch(arr: number[], l: number, r: number, x: number): number {\n  if (r >= l) {\n    const mid = Math.floor((l + r) / 2);\n    if (arr[mid] === x) {\n      return mid;\n    }\n    if (arr[mid] > x) {\n      return binarySearch(arr, l, mid - 1, x);\n    }\n    return binarySearch(arr, mid + 1, r, x);\n  }\n  return r;\n}\n","/**\n * @licence\n * Copyright (c) 2021,  Reader Authors\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"],"sourceRoot":"webpack:///"}